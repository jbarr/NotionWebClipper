let youtube_video_link=null,youtube_video_title=null;function cancelSaveImage(e){youtube_video_link=null,youtube_video_title=null,document.querySelector(".lottie-container")&&document.querySelector(".lottie-container").remove(),document.getElementById("prototionDialogBox")&&(document.getElementById("prototionDialogBox").innerHTML="",document.getElementById("prototionDialogBox").remove()),document.querySelector(".prototionBackdropWrapper")&&document.querySelector(".prototionBackdropWrapper").remove()}function handler(e){const t=e.target;if(t.getAttribute("src")&&t.offsetHeight>100&&t.offsetWidth>100&&(/^https/.test(t.getAttribute("src"))||/^http/.test(t.getAttribute("src")))){t.getAttribute("src").startsWith("https://i.ytimg.com/")?(youtube_video_link=t.closest("a").href,youtube_video_title=1===document.location.href.split("watch?v").length?t?.closest("div#content")?.querySelector("a#video-title-link")?.getAttribute("title"):t.closest("div#dismissible").querySelector("span#video-title").getAttribute("title")):(youtube_video_link=null,youtube_video_title=null);const e=t.getBoundingClientRect();if(document.querySelector("body .notion-pro-clipper__button--hover")){const t=document.querySelector("body .notion-pro-clipper__button--hover");t.style.position="absolute",t.style.display="block",t.style.top=e.y+10+document.documentElement.scrollTop+"px",t.style.left=e.x+10+"px"}else{const t=document.createElement("span");t.innerHTML="Save",t.setAttribute("class","notion-pro-clipper__button--hover"),t.style.position="absolute",t.style.display="block",t.style.top=e.y+10+document.documentElement.scrollTop+"px",t.style.left=e.x+10+"px",document.body.appendChild(t)}document.querySelector("body .notion-pro-clipper__button--hover").addEventListener("click",(function e(o){let i;i=youtube_video_link&&youtube_video_title?{heading:"Video URL",url:youtube_video_link}:{heading:"Image Preview",url:t.getAttribute("src")},renderSaveImageDialog(i);try{button_save.removeEventListener("click",e)}catch{}}))}else{if(e.target.classList.contains("notion-pro-clipper__button--hover"))return;document.querySelector("body .notion-pro-clipper__button--hover")&&(youtube_video_link=null,youtube_video_title=null,document.querySelector("body .notion-pro-clipper__button--hover").style.display="none")}}function saveImageToNotion(){if(!document.body.getAttribute("prototion-web-clipper"))if(document.body.setAttribute("prototion-web-clipper",!0),document.querySelector(".ytName")&&document.querySelector(".ytLink")){const e=document.querySelector(".ytLink").href,t=document.querySelector(".ytName").textContent,o=`<h2>Link</h2><a href=${e}>${t}<a/>`;AddTo.innerHTML=`<span>${selectedDB.name}</span>`;const i="https://res.cloudinary.com/skynox-tech/image/upload/v1631102330/Notion%20Pro%20Clipper/static/success_mcyvc3.gif";dialogBox.innerHTML=`\n            <div class="lottie-container">\n            <div class="lottie-imageContainer">\n            <img src=${i}></img>\n            </div>\n            <p>URL Saved To Notion<p>\n            </div>\n          `,chrome.runtime.sendMessage({message:"save-url-request",payload:{title:t,url:e,content:o}},(e=>{if("save_url_success"===e.message)cancelSaveImage(),document.body.removeAttribute("prototion-web-clipper");else if("save_url_failure"===e.message){const e="https://res.cloudinary.com/skynox-tech/image/upload/v1631102409/Notion%20Pro%20Clipper/static/error_azjn51.gif";dialogBox.innerHTML=`\n            <div class="lottie-container">\n            <div class="lottie-imageContainer">\n            <img src=${e}></img>\n            </div>\n              <p>Oops! Something Went Wrong. Please report this issue, We will get it fixed as soon as possible.<p>\n              <div class="notion-pro-clipper-error-container">\n              <div class="notion-pro-clipper-report notion-clipper-button-primary-report">Report</div>\n              <div class="ignore-btn-notion-pro-clipper notion-clipper-button-secondary-ignore">Ignore</div>\n              </div>\n            </div>\n          `,document.querySelector(".notion-pro-clipper-report").addEventListener("click",(()=>{cancelSaveImage(),window.open("https://forms.clickup.com/f/1rz92-8524/INOKPBNXCK5O3NE46S","_blank")})),document.querySelector(".ignore-btn-notion-pro-clipper").addEventListener("click",(()=>{cancelSaveImage(),document.body.removeAttribute("prototion-web-clipper")}))}}))}else{const e=pageTitleInput.value,t=`<img src=${linkDisplayImage.getAttribute("src")}></img>`;if(e&&t){AddTo.innerHTML=`<span>${selectedDB.name}</span>`;const o="https://res.cloudinary.com/skynox-tech/image/upload/v1631102330/Notion%20Pro%20Clipper/static/success_mcyvc3.gif";dialogBox.innerHTML=`\n              <div class="lottie-container">\n              <div class="lottie-imageContainer">\n              <img src=${o}></img>\n              </div>\n                <p>Image Saved To Notion<p>\n              </div>\n            `,chrome.runtime.sendMessage({message:"uploaded-save-image-request",payload:{title:e,content:t}},(e=>{if("save_image_success"===e.message)cancelSaveImage(),document.body.removeAttribute("prototion-web-clipper");else if("save_image_failure"===e.message){const e="https://res.cloudinary.com/skynox-tech/image/upload/v1631102409/Notion%20Pro%20Clipper/static/error_azjn51.gif";dialogBox.innerHTML=`\n                <div class="lottie-container">\n                <div class="lottie-imageContainer">\n                <img src=${e}></img>\n                </div>\n                  <p>Image Saved To Notion<p>\n                </div>\n              `,setTimeout((()=>{cancelSaveImage(),document.body.removeAttribute("prototion-web-clipper")}),2e3)}}))}}}var dialogBox=document.createElement("div"),LargedialogBox=document.createElement("div"),RightBox=document.createElement("div"),LeftBox=document.createElement("div"),heading=document.createElement("div"),divider=document.createElement("div"),subHeading1=document.createElement("div"),subHeading2=document.createElement("div"),linkPreview=document.createElement("div"),linkDisplayImage=document.createElement("img"),linkDisplayTitle=document.createElement("div"),linkDisplay=document.createElement("div"),pageTitleHeading=document.createElement("div"),pageTitleInput=document.createElement("input"),pageDataBaseHeading=document.createElement("div"),saveImageButton=document.createElement("div"),cancelButton=document.createElement("div"),backdrop=document.createElement("div"),AddToHeading=document.createElement("div"),AddTo=document.createElement("div"),backButton=document.createElement("div"),searchInput=document.createElement("input"),notionDataBox=document.createElement("div"),notionDbBox=document.createElement("div"),notionPagesBox=document.createElement("div"),notionDbBoxSearched=document.createElement("div"),notionPagesBoxSearched=document.createElement("div"),ytBox=document.createElement("div"),ytName=document.createElement("div"),ytLink=document.createElement("a");function makingSaveImageModal(){dialogBox.innerHTML="",dialogBox.id="prototionDialogBox",heading.classList.add("notion-clipper-heading"),divider.classList.add("notion-clipper-divider"),subHeading1.classList.add("notion-clipper-subHeading"),linkPreview.classList.add("notion-clipper-linkPreview-box"),linkDisplayImage.classList.add("linkDisplayImage"),linkDisplayTitle.classList.add("linkDisplayTitle"),linkDisplayTitle.classList.add("notion-clipper-subHeading"),linkDisplay.classList.add("linkDisplay"),linkDisplay.classList.add("notion-clipper-subHeading"),pageTitleHeading.classList.add("notion-clipper-subHeading"),pageTitleInput.classList.add("notion-clipper-input-style"),ytBox.classList.add("ytBox"),ytName.classList.add("ytName"),ytLink.classList.add("ytLink"),AddToHeading.classList.add("notion-clipper-subHeading"),AddToHeading.innerText="Adding to",AddTo.classList.add("AddTo"),AddTo.innerHTML=`<span>${selectedDB.name}</span>`,AddTo.addEventListener("click",(()=>{dialogBox.classList.add("search-active")})),backButton.addEventListener("click",(()=>{dialogBox.classList.remove("search-active")})),notionDbBoxSearched.classList.add("hideComplete"),notionPagesBoxSearched.classList.add("hideComplete"),searchInput.addEventListener("keyup",(e=>{0===e.target.value.length?(notionDbBox.classList.remove("hideComplete"),notionPagesBox.classList.remove("hideComplete"),notionDbBoxSearched.classList.add("hideComplete"),notionPagesBoxSearched.classList.add("hideComplete")):(notionDbBox.classList.add("hideComplete"),notionPagesBox.classList.add("hideComplete"),notionDbBoxSearched.classList.remove("hideComplete"),notionPagesBoxSearched.classList.remove("hideComplete"))}));const e=((e,t)=>{let o;return function(){const i=this,n=arguments;clearTimeout(o),o=setTimeout((()=>{e.apply(i,[n])}),t)}})((e=>{chrome.runtime.sendMessage({message:"get_pages",payload:{query:e[0].target.value}},(e=>{notionDbBoxSearched.innerHTML="",notionPagesBoxSearched.innerHTML="",e.forEach((e=>{if("collection_view"===e.record.type){var t=document.createElement("div"),o=(i=document.createElement("span")).cloneNode(!0);n=e.record.iconEmoji?e.record.iconEmoji:"âœ¨",t.classList.add("listItem"),t.appendChild(i),t.appendChild(o),t.id=e.record.id,t.firstChild.innerHTML=n,t.childNodes[1].innerHTML=e.record.name,notionDbBoxSearched.appendChild(t),t.addEventListener("click",(()=>{AddTo.innerHTML=`<span>${e.record.name}</span>`,selectedDB=e.record,chrome.storage.local.set({selectedDB:{type:"collection",id:e.record.collectionId,parentId:e.record.id,name:e.record.name,icon:n}}),document.querySelector("#prototionDialogBox")?dialogBox.classList.remove("search-active"):document.querySelector("#prototionBigDialogBox")&&document.querySelector(".notion-clipper-right").classList.remove("search-active"),searchInput.value="",notionDbBox.classList.remove("hideComplete"),notionPagesBox.classList.remove("hideComplete"),notionDbBoxSearched.classList.add("hideComplete"),notionPagesBoxSearched.classList.add("hideComplete")}))}else if("page"===e.record.type){var i,n;t=document.createElement("div"),o=(i=document.createElement("span")).cloneNode(!0);n=e.record.iconEmoji?e.record.iconEmoji:"âœ¨",t.classList.add("listItem"),t.appendChild(i),t.appendChild(o),t.id=e.record.id,t.firstChild.innerHTML=n,t.childNodes[1].innerHTML=e.record.name,notionPagesBoxSearched.appendChild(t),t.addEventListener("click",(()=>{AddTo.innerHTML=`<span>${e.record.name}</span>`,selectedDB=e.record,chrome.storage.local.set({selectedDB:{type:"block",id:e.record.id,parentId:e.record.id,name:e.record.name,icon:n}}),document.querySelector("#prototionDialogBox")?dialogBox.classList.remove("search-active"):document.querySelector("#prototionBigDialogBox")&&document.querySelector(".notion-clipper-right").classList.remove("search-active"),searchInput.value="",notionDbBox.classList.remove("hideComplete"),notionPagesBox.classList.remove("hideComplete"),notionDbBoxSearched.classList.add("hideComplete"),notionPagesBoxSearched.classList.add("hideComplete")}))}}))}))}),500);searchInput.addEventListener("input",e),backButton.classList.add("backButton"),backButton.innerHTML="&#171;&nbsp;&nbsp;Go Back",searchInput.classList.add("notion-clipper-search-input"),searchInput.setAttribute("placeholder","Search for pages..."),notionDataBox.classList.add("notionDataBox"),notionDbBox.classList.add("notionDbBox"),notionPagesBox.classList.add("notionPagesBox"),notionDbBoxSearched.classList.add("notionDbBoxSearched"),notionPagesBoxSearched.classList.add("notionPagesBoxSearched"),saveImageButton.classList.add("notion-clipper-button-primary"),saveImageButton.innerHTML="Save",saveImageButton.style.pointerEvents="auto",cancelButton.classList.add("notion-clipper-button-secondary"),cancelButton.innerHTML="Cancel",backdrop.setAttribute("class","prototionBackdropWrapper"),backdrop.appendChild(dialogBox),document.querySelector("body").appendChild(backdrop)}function renderSaveImageDialog(e){makingSaveImageModal(),heading.innerText=e.heading,pageTitleInput.value=document.title,dialogBox.appendChild(heading),dialogBox.appendChild(divider),youtube_video_link&&youtube_video_title?(ytBox.appendChild(ytName),ytBox.appendChild(ytLink),ytName.innerHTML=youtube_video_title,ytLink.innerHTML=youtube_video_link,ytLink.setAttribute("href",youtube_video_link),dialogBox.appendChild(ytBox)):(linkDisplayImage.setAttribute("src",e.url),linkPreview.appendChild(linkDisplayImage),dialogBox.appendChild(subHeading1),subHeading1.innerHTML="Image Preview",dialogBox.appendChild(linkPreview),dialogBox.appendChild(pageTitleHeading),pageTitleHeading.innerHTML="Name",dialogBox.appendChild(pageTitleInput)),dialogBox.appendChild(AddToHeading),dialogBox.appendChild(AddTo),dialogBox.appendChild(backButton),dialogBox.appendChild(pageDataBaseHeading),dialogBox.appendChild(searchInput),dialogBox.appendChild(notionDataBox),notionDataBox.appendChild(notionDbBox),notionDataBox.appendChild(notionPagesBox),notionDataBox.appendChild(notionDbBoxSearched),notionDataBox.appendChild(notionPagesBoxSearched),dialogBox.appendChild(saveImageButton),dialogBox.appendChild(cancelButton),void 0!==typeof window&&window.scroll(0,0),saveImageButton.addEventListener("click",(()=>{saveImageButton.innerHTML=getSpinnerHTML(),saveImageButton.style.pointerEvents="none",saveImageToNotion()})),cancelButton.addEventListener("click",cancelSaveImage)}function getSpinnerHTML(){return'\n  <div class="sk-fading-circle">\n  <div class="sk-circle1 sk-circle"></div>\n  <div class="sk-circle2 sk-circle"></div>\n  <div class="sk-circle3 sk-circle"></div>\n  <div class="sk-circle4 sk-circle"></div>\n  <div class="sk-circle5 sk-circle"></div>\n  <div class="sk-circle6 sk-circle"></div>\n  <div class="sk-circle7 sk-circle"></div>\n  <div class="sk-circle8 sk-circle"></div>\n  <div class="sk-circle9 sk-circle"></div>\n  <div class="sk-circle10 sk-circle"></div>\n  <div class="sk-circle11 sk-circle"></div>\n  <div class="sk-circle12 sk-circle"></div>\n</div>\n  '}document.head.insertAdjacentHTML("beforeend",' <style>@import url("https://fonts.googleapis.com/css2?family=Manrope&display=swap");</style>'),chrome.runtime.onMessage.addListener((function(e,t,o){return"sendImgUrl"===e.message?renderSaveImageDialog(e.payload.data):"showButtonOnHover"===e.message?(document.body.setAttribute("listener",!0),document.body.addEventListener("mouseover",handler)):"removeButtonOnHover"===e.message&&(document.body.removeEventListener("mouseover",handler),document.body.removeAttribute("listener")),!0})),chrome.runtime.sendMessage({message:"is_show_button_on_hover"});